<?php
 namespace FreePBX\Console\Command; use Informunity\Classes\clearCache; use Informunity\Classes\Config; use Informunity\Classes\Offline; use Informunity\Log; use Informunity\Rest\App\CheckRegistration; use Informunity\Rest\App\Recordings\ResendRecords; use Symfony\Component\Console\Command\Command; use Symfony\Component\Console\Input\InputArgument; use Symfony\Component\Console\Input\InputInterface; use Symfony\Component\Console\Input\InputOption; use Symfony\Component\Console\Output\OutputInterface; use Symfony\Component\Console\Style\SymfonyStyle; class Informunity extends Command { protected function configure() { $this->setName("\151\156\x66\157\162\x6d\165\156\151\164\171")->setAliases(array("\x69\165"))->setDescription("\x4d\157\x64\165\154\145\40\x68\145\154\x70")->setDefinition(array(new InputArgument("\141\162\147\x73", InputArgument::IS_ARRAY, null, null))); } protected function execute(InputInterface $input, OutputInterface $output) { goto hu5EG; CkSUY: $command = isset($args[0]) ? $args[0] : ''; goto psLVp; pg08D: $iub24 = \FreePBX::create()->iub24; goto odejN; aBh55: if ($args[2]) { goto vSPXD; } goto lT6n3; y3HMT: echo $this->QueryRest($command, $config, $args); goto K8Izq; SGP9v: gfJQG: goto TuSj5; psLVp: $io = new SymfonyStyle($input, $output); goto pg08D; YGc8U: ooL1Y: goto oDued; abMuX: goto BWRu1; goto wOjsN; hu5EG: $args = $input->getArgument("\141\x72\147\x73"); goto CkSUY; TuSj5: goto ooL1Y; goto uIKGR; odejN: $iub24->config["\141\163\164\145\x72\x69\163\x6b\137\143\x61\x6c\x6c\151\144"] = $args[1]; goto KZ1qy; wOjsN: vSPXD: goto y3HMT; uIKGR: YfCKz: goto yKaLD; TXP3R: if (method_exists($this, $command)) { goto UeKXV; } goto aBh55; edZFL: goto gfJQG; goto hzGHQ; KZ1qy: $config = $iub24->config; goto zDUKz; yKaLD: \Informunity\Console\Custom::$command($config); goto YGc8U; lT6n3: $this->help($io); goto abMuX; K8Izq: BWRu1: goto edZFL; hzGHQ: UeKXV: goto lra3u; zDUKz: if (class_exists("\134\111\x6e\146\157\x72\x6d\165\156\x69\164\x79\x5c\103\x6f\x6e\163\x6f\154\145\x5c\103\165\163\x74\157\x6d") && method_exists("\134\x49\156\146\157\x72\x6d\x75\156\151\x74\171\x5c\103\x6f\156\163\157\154\x65\x5c\x43\x75\x73\x74\157\155", $command)) { goto YfCKz; } goto TXP3R; lra3u: $this->{$command}($io, $args, $iub24); goto SGP9v; oDued: } public function help($io) { goto V0JQb; QGDkE: $io->newLine(); goto sTatx; V0JQb: $io->title("\x41\x76\141\x69\x6c\141\x62\x6c\145\x20\160\x61\x72\x61\x6d\x73\72"); goto QN0CL; QN0CL: $io->table(array("\117\160\164\x69\x6f\x6e", "\104\x65\163\x63\x72\151\160\164\x69\157\156"), array(array("\x3c\151\156\146\x6f\76" . _("\x68\145\154\160") . "\74\57\151\156\146\x6f\x3e", "\x54\x68\x69\163\40\151\156\146\x6f"), array("\74\x69\x6e\x66\x6f\76" . _("\162\145\146\x72\145\163\150\57\x72") . "\74\x2f\151\156\x66\157\x3e", "\x55\160\x64\x61\164\145\x20\x74\157\153\x65\156\x73"), array("\x3c\151\x6e\146\x6f\76" . _("\163\145\x6e\x64\57\163") . "\x3c\57\x69\x6e\146\157\x3e", "\x53\x65\156\144\40\161\165\145\x75\x65\144\40\x72\x65\x63\x6f\162\144\x73"), array("\x3c\151\156\x66\157\76" . _("\x63\154\145\141\156\57\x63") . "\74\x2f\x69\156\x66\157\76", "\103\154\x65\141\x6e\x75\160\x20\x72\145\x67\x69\x73\164\x72\141\164\151\x6f\156\40\x74\x6f\x6b\145\156\163"), array("\x3c\x69\x6e\x66\x6f\x3e" . _("\151\162") . "\74\57\151\x6e\146\157\x3e", "\x45\x6e\141\142\x6c\x65\40\157\162\x20\144\x69\x73\141\142\x6c\145\40\151\x6e\x62\157\x75\x6e\x64\x20\162\x6f\x75\164\145\x20\x75\163\141\147\x65\40\x74\x65\x73\164\56\x20\123\141\155\145\40\x6c\x69\x6b\145\40\x69\156\x20\155\157\x64\165\x6c\x65\40\x55\x72\x6c\40\46\151\x72\x3d\x65\x20\x26\151\x72\75\x64\x20"), array("\x3c\x69\x6e\x66\157\x3e" . _("\143\157\x6e\146\x69\x67") . "\x3c\x2f\151\156\146\x6f\76", "\x47\145\164\x20\143\x75\x73\164\x6f\155\40\143\x6f\156\146\151\147\163"), array("\x3c\x69\156\146\157\x3e" . _("\x74\x65\163\164\x64\160") . "\x3c\x2f\151\x6e\x66\157\x3e", "\x43\x68\145\x63\153\x20\162\157\x75\164\x65\x20\146\x6f\x72\40\156\165\155\142\x65\x72"))); goto QGDkE; sTatx: } public function clean($io) { goto Inm0X; bcm4k: $sql = "\125\120\104\x41\124\105\40\151\x75\142\62\64\40\123\105\124\40\x74\157\x6b\145\156\75\47\47\x2c\40\x72\145\146\162\145\163\150\x5f\x74\157\x6b\145\156\75\x27\x27\54\40\145\x78\x70\x69\162\145\x73\75\x27\x27\54\155\145\x6d\142\145\x72\x5f\151\144\x3d\x27\x27\40\127\x48\105\x52\105\x20\x69\144\x3d\x30"; goto jwh4K; cZcdJ: $io->text("\x3c\x69\x6e\146\x6f\76" . _("\122\145\x67\x69\x73\x74\162\x61\x74\x69\x6f\156\x20\x64\x61\x74\141\40\151\163\40\x63\154\145\141\x6e\145\x64") . "\74\x2f\151\x6e\x66\x6f\x3e"); goto ulCzv; Inm0X: $db = \FreePBX::Database(); goto bcm4k; KTakf: $q->execute(); goto cZcdJ; jwh4K: $q = $db->prepare($sql); goto KTakf; ulCzv: } public function c($io) { $this->clean($io); } public function ir($io, $data, $iub24) { goto Xn1HO; Xn1HO: if (!isset($data[1])) { goto H0pFE; } goto qmUZb; qmUZb: $iub24->setDestinationsCheck($data[1]); goto aUDVF; aUDVF: $io->text("\x44\x6f\x6e\145"); goto r1uHf; YIXul: return false; goto slASZ; r1uHf: H0pFE: goto YIXul; slASZ: } public function ur($io, $data, $iub24) { unset($io, $data); $iub24->ManageRegions(); } public function send($io, $data, $iub24) { unset($io, $data); ResendRecords::load($iub24->config)->Run(); } public function debug($io, $data, $iub24) { goto ebASM; WR3Es: goto rJo8V; goto bksp6; yCGqL: rJo8V: goto Wfr3L; bksp6: GuyFW: goto n2BDm; ebASM: unset($io); goto zNLxS; WhLqX: i9ccp: goto yCGqL; n2BDm: switch (strtolower($data[1])) { case "\x6f\156": goto Rebcx; EviUN: return "\x44\145\x62\165\x67\x20\x73\164\141\x72\x74\145\x64"; goto IxR5L; Rebcx: if (file_exists($file)) { goto yOF6g; } goto RY5pL; SaNnz: goto i9ccp; goto RYTaD; IxR5L: yOF6g: goto SaNnz; RY5pL: file_put_contents($file, "\43\100\x53\164\141\x72\x74"); goto CIPsr; CIPsr: chown($file, "\141\163\x74\145\x72\x69\163\153"); goto EviUN; RYTaD: case "\x6f\146\x66": goto PD08h; NYdiM: return "\103\154\x65\141\x6e\x65\x64\40\141\x6e\144\40\104\151\x73\x61\142\154\145\144"; goto ZAHI4; PD08h: if (!file_exists($file)) { goto GEfSM; } goto Lq7wU; HoGTl: goto i9ccp; goto FlDoZ; Lq7wU: unlink($file); goto NYdiM; ZAHI4: GEfSM: goto HoGTl; FlDoZ: } goto sdocs; sdocs: UBElp: goto WhLqX; zNLxS: $file = $iub24->config["\143\157\x6e\x66\137\144\x69\162"] . "\144\x65\x62\x75\x67"; goto CJxE1; Wfr3L: return false; goto IVecx; KjLiL: return "\104\x65\x62\165\147\x20" . $result; goto WR3Es; f0TdZ: $result = file_exists($file) ? "\105\156\141\142\x6c\x65\x64" : "\104\x69\x73\x61\142\x6c\145\144"; goto KjLiL; CJxE1: if ($data[1]) { goto GuyFW; } goto f0TdZ; IVecx: } public function testdp($io, $data) { goto RhUm4; yXPkV: EiG6s: goto XUIRN; QZ11_: goto EiG6s; goto AofcN; v6kan: $result = $astman->send_request("\x53\150\x6f\x77\x44\151\141\154\120\154\x61\156", array("\x45\x78\164\x65\156\x73\x69\157\156" => $data[2], "\x43\x6f\x6e\x74\145\170\x74" => "\146\162\x6f\x6d\55\x69\156\x74\145\x72\x6e\x61\x6c")); goto uhj2E; CLK9H: $io->section("\x55\163\141\147\x65\x20\x3a\x20\74\x69\156\146\157\x3e" . _("\x66\x77\x63\157\156\163\157\x6c\145\x20\151\x75\x20\164\x65\163\x74\144\x70\x20\x5c\x3c\160\x68\x6f\x6e\145\40\156\165\155\x62\145\162\76") . "\x3c\x2f\151\x6e\x66\x6f\76"); goto v5BQC; AofcN: f2Qok: goto bbujm; RhUm4: if (!empty($data[2])) { goto f2Qok; } goto CLK9H; uhj2E: $io->table(array("\x52\x65\163\160\157\156\143\145", "\115\x65\163\x73\141\x67\145"), $this->setConfTable($result)); goto yXPkV; XUIRN: return false; goto VY9Yg; v5BQC: return "\105\x78\x61\x6d\160\x6c\x65\72\x20\x66\167\x63\x6f\156\x73\x6f\x6c\145\x20\151\x75\40\x74\145\163\x74\x64\x70\40\53\61\70\60\60\x37\67\x37\63\x33\x32\62"; goto QZ11_; bbujm: global $astman; goto v6kan; VY9Yg: } public function rc($io, $data) { goto h6Tmx; AtsJ9: $db = \FreePBX::Database(); goto P83XE; h6Tmx: if (!$data[2]) { goto GbdEq; } goto AtsJ9; P83XE: $sql = "\x55\x50\104\101\x54\x45\40\x69\165\x62\62\64\40\123\x45\x54\40\x72\157\165\x74\145\103\x68\145\143\153\x3d\x3a\162\x6f\165\x74\x65\103\150\145\x63\153\40\127\x48\105\x52\x45\x20\x69\x64\75\60"; goto fm4Cz; FXoDL: GbdEq: goto cEjU5; eI2lF: $q->bindParam("\x3a\x72\157\165\x74\x65\103\150\145\x63\x6b", $data[2], \PDO::PARAM_STR); goto Iv4st; GFAmD: $io->text("\104\157\156\145"); goto FXoDL; fm4Cz: $q = $db->prepare($sql); goto eI2lF; Iv4st: $q->execute(); goto GFAmD; cEjU5: } public function token($io, $data) { goto aOVye; XFtmo: e1vKf: goto URfJo; aOVye: if (!isset($data[2])) { goto e1vKf; } goto D59J1; D59J1: $io->text(encrypt_decrypt($data[1], $data[2])); goto XFtmo; URfJo: } public function config($io, $data, $iub24) { goto DpRWz; gbX3P: goto UzoWd; goto tHs0K; A8F6P: $io->section("\x43\x6f\156\146\151\x67\x73\40\141\166\x61\151\154\141\x62\x6c\x65\x20\146\157\162\40\x63\x75\163\x74\157\x6d\151\172\x61\x74\x69\157\156\40\72"); goto qs0Lx; a7i89: Config::saveConfigFile($iub24->config, $CustomConf, $data[1]); goto DxjMu; DpRWz: if (empty($data[1])) { goto z_DFI; } goto K6h4S; tHs0K: z_DFI: goto A8F6P; aMCha: TPDsw: goto qNuFu; g3PCc: $io->table(array("\117\x70\164\151\x6f\x6e", "\120\x61\162\141\155\145\x74\x72\x73"), Config::setConfTable($CustomConf)); goto YR7N2; SZSmJ: UzoWd: goto Sa5jw; MRicr: if (!(!empty($CustomConf) && $data[2] === "\x73\141\166\x65")) { goto LLndz; } goto a7i89; FvHrj: switch ($data[1]) { case "\123\x54\101\x54\x55\123\137\103\117\104\105\x53": $CustomConf = Config::LoadStatusArray($iub24->config); goto PHDaA; case "\163\x6f\x78": $CustomConf = Config::GetSoxConfig($iub24->config); goto PHDaA; default: goto PHDaA; } goto aMCha; K6h4S: $CustomConf = array(); goto FvHrj; YR7N2: $io->note("\x50\x61\164\x61\x6d\145\x74\162\163\x20\x61\x72\162\x61\x79\x20\x69\156\x74\145\x72\160\x72\x69\164\x61\164\x69\157\x6e\x20\133\x22\x6f\165\164\160\165\164\x22\54\42\151\156\160\165\x74\55\61\x22\x2c\x2e\56\56\x2c\42\x69\156\x70\165\164\x2d\x6e\x22\x5d"); goto WDCZY; WDCZY: eq8az: goto MRicr; DxjMu: LLndz: goto gbX3P; qs0Lx: $io->table(array("\117\160\164\x69\157\x6e", "\104\145\x73\x63\x72\x69\160\x74\151\x6f\x6e"), array(array("\74\x69\156\x66\157\x3e" . _("\x53\x54\x41\124\125\x53\x5f\103\117\104\105\123") . "\74\x2f\151\x6e\x66\x6f\x3e", "\103\x61\154\x6c\x20\x46\x69\x6e\151\x73\150\x20\163\164\x61\x74\x75\163\40\x63\x6f\144\145\x73"), array("\x3c\x69\156\146\x6f\x3e" . _("\163\157\170") . "\x3c\x2f\x69\156\146\157\76", "\123\x6f\x78\40\157\160\164\x69\157\156\x73\40\146\x6f\x72\x20\x53\x74\x65\x72\x65\x6f\40\155\157\144\x65"))); goto SZSmJ; qNuFu: PHDaA: goto lwbGa; lwbGa: if (empty($CustomConf)) { goto eq8az; } goto g3PCc; Sa5jw: } public function QueryRest($command, $config, $data) { goto SaH7K; uuTxB: if (!(class_exists($classname) && in_array("\x52\x75\x6e", get_class_methods($classname)))) { goto BngwM; } goto eYqnk; SaH7K: $classname = "\111\x6e\146\157\x72\x6d\165\156\x69\x74\171\x5c\122\145\163\164\134\x41\160\160\134\103\x61\x6c\x6c\x5c" . $command; goto de_x0; ZCujU: require_once $config["\143\157\156\146\137\x64\151\x72"] . "\x52\145\163\x74\x2f\x41\x70\x70\57\x43\141\x6c\x6c\x2f" . $command . "\56\x70\150\x70"; goto Fbzq3; Fbzq3: xDq5u: goto uuTxB; O8jo8: return false; goto bghGp; eYqnk: return $classname::load($config, $data)->Run(); goto TKIjP; TKIjP: BngwM: goto O8jo8; de_x0: if (!(!class_exists($classname) && file_exists($config["\143\x6f\156\146\137\x64\151\162"] . "\x52\145\x73\x74\x2f\101\x70\160\57\103\141\x6c\x6c\x2f" . $command . "\x2e\160\x68\160"))) { goto xDq5u; } goto ZCujU; bghGp: } public function Finish($io, $data, $iub24) { goto kky62; kBEQu: YVCJl: goto Fr1wc; kS6Nk: if (!$data[2]) { goto YVCJl; } goto AK2po; AK2po: return $this->QueryRest($data[0], $iub24->config, $data); goto kBEQu; Fr1wc: return array(); goto ZAkCb; kky62: unset($io); goto kS6Nk; ZAkCb: } public function Handler($io, $data, $iub24) { goto kZG_T; UhzYe: if (!$data[2]) { goto ogSB5; } goto JkYYO; nQYBe: ogSB5: goto p7kA_; jZFIr: $astman->SetVar($data["\x63\x68\x61\156\156\145\x6c"], "\x43\x48\101\116\116\x45\x4c\50\150\141\x6e\147\x75\x70\137\150\141\156\144\154\x65\x72\137\x70\x75\x73\150\51", "\150\141\156\147\x75\160\x2d\150\x61\x6e\144\154\x65\x72\x2d\157\160\x65\x72\141\x74\x6f\x72\x2c\163\x2c\61"); goto B1QS5; UynFG: if (!$data["\x63\150\141\x6e\x6e\145\x6c"]) { goto jMpst; } goto jZFIr; gdbzX: $data = array_combine(array("\x61\163\x74\x65\162\151\x73\x6b\137\x63\x61\154\154\x69\144", "\143\x68\x61\x6e\x6e\x65\x6c"), explode("\x2c", $data[2])); goto UynFG; B1QS5: jMpst: goto nQYBe; JkYYO: global $astman; goto gdbzX; kZG_T: uset($io, $iub24); goto UhzYe; p7kA_: } public function ClearCache($io, $data, $iub24) { clearCache::Load()->Run($iub24->config); } public function offlineCallsHandler($io, $data, $iub24) { goto NlJBy; VW_JW: if (is_array($calls)) { goto c0RqV; } goto mxRm2; JDhC5: if ($OfflineCalls->CheckPID()) { goto cwC4K; } goto vxHOS; fI5Ti: if (!empty($calls)) { goto X8XB3; } goto j2yMg; p98Nw: DAOEt: goto fwvfz; edATj: $calls = $OfflineCalls->getCalls(2); goto fI5Ti; oCwdo: eaRx5: goto VW_JW; vxHOS: return; goto GtIGp; hzNjX: X8XB3: goto Y6Ufv; j2yMg: return; goto hzNjX; mxRm2: return; goto ES3cd; GtIGp: cwC4K: goto edATj; Y6Ufv: if (CheckRegistration::load($iub24->config, array())->Run()) { goto eaRx5; } goto CZShf; NlJBy: $OfflineCalls = new Offline(); goto JDhC5; ES3cd: c0RqV: goto U2g2H; U2g2H: foreach ($calls as $call) { $OfflineCalls->ProcessCall($iub24->config, $call); fvcTD: } goto p98Nw; CZShf: return; goto oCwdo; fwvfz: } }
