<?php
 namespace Informunity\Rest\App\Recordings; use Informunity\Classes\IUDB; use Informunity\Interfaces\RestAPI; use Informunity\Log; use Informunity\Rest\Custom; use Informunity\Rest\Rest; class AddRecords extends Rest implements RestAPI { public static function load($config, $data = array()) { return Custom::GetCustomData($config, $data, __CLASS__); } public function Run() { goto e1dmi; rVvqU: if (!(!empty($convert["\165\160\144\x61\164\145"]) && is_array($convert["\165\160\x64\141\x74\145"]))) { goto zs7ZP; } goto fNkCc; xMnMl: T5CWv: goto qkrMT; k8E9t: U6KwX: goto GLZXM; vHjsw: if (!file_exists($convert["\165\160\x64\141\x74\145"][0])) { goto ViNyJ; } goto a8b3O; gvSJZ: if (!($this->config["\x72\x65\x63\157\162\x64\151\156\147\x73"] == "\x6c\151\156\153\x73" && $amp_conf["\115\111\x58\x4d\x4f\x4e\137\106\x4f\x52\115\101\x54"] === "\167\141\x76")) { goto f1cbe; } goto Taq1J; oeEMv: if (!($this->config["\162\145\x63\x6f\x72\144\x69\x6e\x67\163"] !== "\x6c\x69\x6e\153\x73")) { goto Dq8tV; } goto EZueR; lUMiz: f1cbe: goto sqlvH; GLZXM: Dq8tV: goto bV_CI; mpvwp: if (empty($filesArray)) { goto U6KwX; } goto TIXKy; qH5SF: q_4KS: goto eDwqy; KNXb7: ViNyJ: goto F5Nqi; bV_CI: goto wDs5_; goto RUwTl; RUwTl: pcFMn: goto sgM6x; YzQY7: wDs5_: goto gvSJZ; Of12z: IUDB::storeFailedRecord($this->data["\x43\x41\x4c\x4c\137\x49\104"], 0, $filesArray[0]); goto qH5SF; sgM6x: $log->toFile(array("\124\x79\160\x65" => $this->config["\x72\145\143\x6f\x72\144\151\156\147\x73"])); goto YzQY7; F5Nqi: if (!isset($result["\x72\145\x73\165\154\x74"]["\x46\x49\114\x45\x5f\x49\x44"])) { goto ZZoDz; } goto oOpbY; fNkCc: if (!(!empty($this->data["\103\101\x4c\114\x5f\x49\x44"]) && !empty($convert["\x75\x70\144\141\x74\x65"][0]))) { goto T5CWv; } goto vHjsw; e1dmi: $this->config["\162\x65\143\x6f\162\x64\151\x6e\x67\163\120\x61\x74\x68"] = $this->getPath(); goto gchCb; ZoHUW: jhEfK: goto Ppk3t; oOpbY: $complete[] = $filesArray[0]; goto R1AoA; i3G1J: yB9RV: goto ROniI; XkiU_: ZZoDz: goto Of12z; fGveX: $log = new Log(array("\x68\145\x61\144\145\162" => "\101\144\x64\x20\162\145\143\x6f\162\144\151\x6e\x67\163", "\141\163\x74\145\162\151\163\x6b\x5f\143\141\x6c\x6c\151\144" => $this->config["\x61\x73\164\145\162\x69\163\x6b\137\143\141\154\154\x69\144"]), $this->config["\154\157\147\147\x69\x6e\147"]); goto t28Wb; LfrEQ: array_unshift($convert["\x75\x70\144\x61\x74\145"], array()); goto PUL4g; Taq1J: $this->updateActivityRecordAsLink(); goto lUMiz; GRNPo: goto xoQyc; goto mX4gf; ROniI: zs7ZP: goto k8E9t; hBwoD: xoQyc: goto i3G1J; mX4gf: VCNqE: goto kHnTB; kHnTB: foreach (array_keys($convert["\x75\x70\144\141\164\145"]) as $key) { IUDB::storeFailedRecord($this->data["\103\122\115\137\x41\x43\124\x49\x56\111\124\x59\x5f\x49\x44"], $key, $filesArray[$key]); z6K0N: } goto ifftv; vz2tz: $update_result = UpdateActivityRecords::load($this->config, array_merge($this->data, array("\x66\151\x6c\x65" => $convert["\165\x70\144\141\164\x65"])))->Run(); goto D_ZkQ; Ppk3t: if (empty($convert["\165\x70\x64\141\164\145"])) { goto yB9RV; } goto vz2tz; R1AoA: goto q_4KS; goto XkiU_; PUL4g: unset($convert["\165\160\144\141\164\145"][0]); goto ZoHUW; YtNGl: foreach (array_keys($convert["\x75\x70\x64\141\164\x65"]) as $key) { $complete[] = $filesArray[$key]; rhBpQ: } goto dfyNr; t28Wb: if ($this->config["\x72\x65\143\157\x72\144\x69\x6e\x67\x73"] == "\x6e\x6f\x74\x5f\x73\145\156\x64") { goto pcFMn; } goto oeEMv; D_ZkQ: if (!$update_result["\x72\x65\163\x75\x6c\x74"]) { goto VCNqE; } goto YtNGl; gchCb: global $amp_conf; goto fGveX; qkrMT: if (!($amp_conf["\x4d\x49\130\115\117\116\137\106\117\122\x4d\101\x54"] == "\127\x41\126" && isset($convert["\x75\x70\144\141\x74\145"][0]))) { goto jhEfK; } goto LfrEQ; TIXKy: try { $convert = ConvertRecords::load($this->config, $filesArray)->Run(); } catch (\Exception $e) { Log::Debug(array("\145\162\162\x20\143\x6f\x6e\x76\145\162\x74" => $e)); } goto rVvqU; dfyNr: jO_7N: goto GRNPo; ifftv: UGRs8: goto hBwoD; a8b3O: $result = AttachRecords::load($this->config, array_merge($this->data, array("\x66\x69\x6c\x65" => $convert["\165\160\x64\x61\164\x65"][0])))->Run(); goto KNXb7; sqlvH: return array("\143\x6f\x6d\160\154\145\164\x65" => isset($complete) ? $complete : array(), "\144\x65\154\x65\x74\145" => !empty($convert["\144\x65\x6c\145\x74\x65"]) ? $convert["\144\145\x6c\x65\164\145"] : array()); goto ACrCU; EZueR: $filesArray = array_unique(array_filter(explode("\x7c", $this->data["\122\x45\103\117\122\x44\x53"]))); goto mpvwp; eDwqy: unset($convert["\165\x70\144\141\x74\145"][0]); goto xMnMl; ACrCU: } public function updateActivityRecordAsLink() { goto fUzLZ; fUzLZ: $filedata = array(); goto AizTi; oqP0v: $log->toFile(array("\106\x69\154\145\x73" => $links, "\101\143\164\151\x76\151\x74\171\x20\111\x44" => $this->data["\103\122\115\137\101\103\124\111\126\x49\x54\x59\x5f\x49\x44"])); goto Qjo6l; jSAje: return array("\162\x65\163\x75\154\164" => "\116\x4f\40\101\143\x74\151\x76\151\164\171\40\111\x44"); goto TVro1; kDGrW: LwG_p: goto aL_JZ; JKLpZ: $files = array_unique(array_filter(explode("\174", $this->data["\x52\105\103\117\x52\x44\x53"]))); goto iR2dy; aL_JZ: return array(); goto KQWuU; u_beM: if (!empty($this->data["\x43\122\115\137\101\x43\124\111\x56\111\x54\x59\137\111\x44"])) { goto iLXkw; } goto jSAje; Qjo6l: return $this->query("\143\162\x6d\x2e\x61\x63\x74\151\166\x69\x74\171\56\165\160\x64\141\164\x65", array("\111\x44" => $this->data["\103\x52\x4d\x5f\101\x43\124\111\x56\x49\124\131\x5f\x49\x44"], "\x66\x69\145\154\x64\x73" => array("\104\x45\x53\103\x52\x49\x50\124\111\x4f\x4e" => $links, "\104\x45\x53\103\x52\111\x50\124\111\117\x4e\137\124\x59\120\x45" => 1))); goto kDGrW; AizTi: $log = new Log(array("\x68\x65\141\x64\x65\162" => "\x4c\x69\x6e\x6b\x2e\x2e\x2e\56\x2e", "\x61\x73\164\145\162\151\x73\153\x5f\143\141\154\154\x69\144" => $this->config["\x61\x73\164\145\162\x69\163\153\x5f\x63\141\154\154\x69\144"]), $this->config["\x6c\157\147\x67\151\x6e\147"]); goto u_beM; Zl0Q_: $links = implode("\12", $filedata); goto oqP0v; TVro1: iLXkw: goto JKLpZ; iR2dy: if (empty($files)) { goto LwG_p; } goto bYkVV; bYkVV: foreach ($files as $file) { goto hNbkv; CtuCH: $mime = "\141\165\x64\151\157\57\x77\141\166"; goto POSMs; XjhAe: $filedata[] = "\74\x61\x75\x64\151\x6f\x20\143\157\x6e\164\162\x6f\154\163\x20\x73\164\x79\154\x65\75\42\150\145\151\147\150\164\x3a\40\x32\60\x70\x78\73\42\76\x3c\163\157\x75\162\x63\145\40\x73\x72\143\75\x22" . $this->config["\x65\170\x74\137\141\x64\144\x72\145\163\163"] . "\57\141\144\155\151\156\57\141\x6a\x61\x78\56\x70\x68\x70\x3f\155\157\144\165\154\145\75\x69\x75\x62\x32\x34\x26\143\x6f\x6d\155\x61\156\x64\75\147\x65\x74\x5f\162\145\x63\x6f\x72\x64\46\162\145\143\157\x72\144\x3d" . urlencode($fpath) . "\x22\x20\x74\171\x70\x65\75\42" . $mime . "\x22\76\74\x2f\x61\165\144\151\x6f\76"; goto ewLbS; xbv1x: goto k50p9; goto vMlLy; fPfkb: SQ5Mx: goto XjhAe; POSMs: global $amp_conf; goto Tbdw8; DFKTy: $log->toFile(array("\x46\151\154\x65\x20\156\x6f\164\40\145\x78\x69\163\164\163" => $fpath)); goto xbv1x; ewLbS: k50p9: goto XMNIq; gGtQI: Mkj3E: goto aEnty; RlPk3: $fpath = $this->config["\x72\145\x63\x6f\x72\144\x69\x6e\147\163\x50\141\164\150"] . $file; goto gGtQI; XMNIq: unset($fpath); goto P8J2F; iL1E4: r3VIo: goto aeKi3; aeKi3: if (isset($fpath)) { goto Mkj3E; } goto RlPk3; L5v2r: $fpath = $file; goto iL1E4; hNbkv: if (!file_exists($file)) { goto r3VIo; } goto L5v2r; aEnty: if (file_exists($fpath)) { goto j6Nqv; } goto DFKTy; P8J2F: x2C7Y: goto YIB4J; Tbdw8: if (!($amp_conf["\115\x49\x58\115\117\116\x5f\x46\x4f\x52\x4d\x41\x54"] === "\127\101\126")) { goto SQ5Mx; } goto KqVQY; vMlLy: j6Nqv: goto CtuCH; KqVQY: $mime = "\141\x75\x64\151\157\57\114\61\x36"; goto fPfkb; YIB4J: } goto TvIky; TvIky: Rr4e_: goto Zl0Q_; KQWuU: } private function getPath() { global $amp_conf; return empty($amp_conf["\115\x49\130\115\117\116\x5f\104\111\122"]) ? $amp_conf["\101\x53\124\x53\120\x4f\x4f\114\x44\x49\x52"] . "\x2f\x6d\157\x6e\151\164\157\x72\57" : $amp_conf["\x4d\x49\x58\115\117\116\137\x44\111\x52"] . "\57"; } }
