<?php
 namespace Informunity\Classes; use Informunity\Astman\SetUserData; use Informunity\Log; use Informunity\ModuleStaticConfig; use Informunity\Rest\App\CheckRegistration; use Informunity\Rest\App\Users\GetUsers; class clearCache { protected $users; public static function Load() { return CustomClassName::Load(__CLASS__); } public function Run($config) { goto jislC; J_FZe: $log = new Log(array("\x68\145\141\x64\x65\x72" => "\103\141\x63\x68\145\x20\103\154\x65\141\162\145\144", "\x61\163\164\x65\x72\151\163\153\x5f\x63\141\x6c\154\151\144" => "\x69\156\164\x65\162\146\x61\x63\145"), $config["\x6c\157\x67\x67\151\156\x67"]); goto NUDgW; zMNSM: $this->getUsers($config); goto VBu6H; j8BOu: Y0XmQ: goto eCpf_; NUDgW: $log->toFile(array("\x43\x61\143\150\145\x20\103\x6c\145\141\162\x65\144" => "\x44\157\x6e\x65")); goto HjP28; HjP28: return $this->updateBitrixUsers($config); goto jzAyK; aVSD_: $this->clearAstDB(); goto j8BOu; jislC: $this->clearSession(); goto Atr2w; Atr2w: $this->clearStereoFiles(); goto zMNSM; VBu6H: if (empty($this->users)) { goto Y0XmQ; } goto aVSD_; eCpf_: $this->setUsers(); goto J_FZe; jzAyK: } protected function clearAstDB() { global $astman; $astman->database_deltree("\x49\x55\102\x32\64"); } protected function clearSession() { goto aX0TM; giyYH: unset($_SESSION["\151\x75\x62\62\x34\x5f\x75\163\x65\x72\163\x5f\x61\143\164\x75\141\154"]); goto O3je_; NXi3L: unset($_SESSION["\x69\165\x62\62\64\x5f\163\x6f\165\x72\143\145\163\137\x61\143\164\165\141\x6c"]); goto igBR3; jucf2: session_start(); goto OvGwV; O3je_: unset($_SESSION["\x69\165\142\62\x34\x5f\x73\x6f\165\x72\143\x65\163"]); goto NXi3L; OvGwV: YZdUe: goto TDSQ3; TDSQ3: unset($_SESSION["\x69\165\x62\62\x34\x5f\165\163\x65\x72\163"]); goto giyYH; aX0TM: if (isset($_SESSION)) { goto YZdUe; } goto jucf2; igBR3: } protected function clearStereoFiles() { system(fpbx_which("\x66\151\156\x64") . "\40\x2f\166\141\x72\57\163\x70\157\x6f\x6c\x2f\x61\163\164\x65\x72\151\x73\153\57\155\157\x6e\151\x74\157\x72\57\x20\55\156\x61\x6d\x65\x20\x2a\163\x69\x64\145\x2e\167\x61\x76\x2a\40\55\x74\x79\x70\x65\40\146\x20\55\155\164\151\155\x65\x20\61\x20\55\x65\x78\x65\143\40\162\x6d\40\55\x72\40\173\175\40\x5c\73"); } protected function getUsers($config) { $this->users = GetUsers::load($config)->Run(); } protected function setUsers() { goto ENuqM; PEYYN: glGsK: goto a0Hav; ENuqM: if (!(!empty($this->users) && is_array($this->users))) { goto glGsK; } goto uWsiA; uWsiA: foreach ($this->users as $user) { SetUserData::Load($user)->Set(); ohi9B: } goto YDOmk; YDOmk: AkdXA: goto PEYYN; a0Hav: } protected function updateBitrixUsers($config) { goto rsT61; HJE05: Sdw6d: goto m0en5; BN1Df: $res = $config["\114\151\143\x65\156\163\145"]->Request($moduleConfig["\154\x69\x63\145\156\x73\145"]["\x73\x65\x72\166\145\162"] . $moduleConfig["\x6c\151\x63\x65\x6e\x73\x65"]["\162\157\165\x74\145"]["\165\160\144\x61\x74\145\137\x75\163\145\x72\x73"], "\165\x70\144\x61\x74\x65\137\x75\x73\145\162\x73", $fields); goto kR3vQ; hC8pe: if (!$isRegistred) { goto V6gpy; } goto stVMb; m0en5: V6gpy: goto zpfcA; stVMb: $moduleConfig = ModuleStaticConfig::load()->get(); goto XpVPy; kR3vQ: if (isset($res["\x64\164\x5f\x73\164\141\x74\165\163"]) && $res["\144\164\137\163\164\141\x74\165\163"] == "\x73\165\x63\143\x65\x73\x73") { goto ek29Q; } goto XwMN9; XwMN9: return false; goto wttbB; wttbB: goto Sdw6d; goto mg326; rsT61: $isRegistred = $config["\164\x6f\153\x65\156"] && CheckRegistration::load($config, array())->Run(); goto hC8pe; cE2dd: return array("\141\x63\164\x69\x6f\156\x73" => array("\147\145\164\123\157\165\162\143\x65\163", "\147\145\x74\x55\x73\145\x72\x73", "\147\145\x74\114\x69\x63\x65\x6e\x73\145\x49\x6e\x66\x6f\162\155\x61\x74\x69\157\156")); goto HJE05; XpVPy: $fields = array("\x75\x72\154\x5f\x62\62\x34" => "\143\x6c\151\145\x6e\164\137\163\x65\x72\166\x65\x72", "\x6d\145\x6d\142\145\x72\137\x69\144" => "\155\145\x6d\x62\145\162\x5f\x69\144", "\164\x6f\x6b\x65\156" => "\164\x6f\153\145\x6e"); goto BN1Df; mg326: ek29Q: goto cE2dd; zpfcA: } }
