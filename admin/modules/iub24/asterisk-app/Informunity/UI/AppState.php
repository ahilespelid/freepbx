<?php
 namespace Informunity\UI; use Informunity\Classes\InCall; use Informunity\Log; use Informunity\Rest\App\CheckRegistration; use Informunity\UI\Classes\Custom; use Informunity\UI\Classes\Field; use Informunity\UI\Classes\Item; use Informunity\UI\Classes\Panel; use Informunity\UI\Classes\State; use Informunity\UI\Helpers\Recordings; use Informunity\UI\Panels\Groups; use Informunity\UI\Panels\HeadersToFields; use Informunity\UI\Panels\Lines; use Informunity\UI\Panels\OutboundRoutes; use Informunity\UI\Panels\ProxySettings; use Informunity\UI\Panels\RegistrationData; use Informunity\UI\Panels\RoutingPoints; use Informunity\UI\Panels\Settings; use Informunity\UI\Panels\Tasks; use Informunity\UI\Panels\UponACall; class AppState { public $state; protected $config; protected $options; protected $sangomaCRM; protected $registered; protected $authenticated; public static function Load($config, $options) { return Custom::GetCustomData($config, $options, __CLASS__); } public function get() { return $this->state; } public function __construct($config, $options) { goto WjlPD; OWu0T: $this->sangomaCRM = \FreePBX::Modules()->checkStatus("\x73\x61\156\147\x6f\x6d\x61\x63\162\155"); goto T6gwd; T6gwd: $this->collect(); goto jumHM; WjlPD: $this->config = $config; goto JWZI4; JWZI4: $this->options = $options; goto OWu0T; jumHM: } protected function collect() { goto tBNZ0; F5nxe: tQjNx: goto FexVE; HVNpR: $this->setMessages(); goto YH9Hv; Wd3IE: return; goto cmwvh; jdmj_: $this->setLinesPanel(); goto YiOIh; hcXQb: $this->setUponACallPanel(); goto FoyYQ; FoyYQ: if (!(!empty($this->config["\x68\x65\141\x64\x65\162\x73"]) && $this->config["\x68\145\141\144\145\162\x73"])) { goto tQjNx; } goto JPjHz; rxJhX: $this->setOutboundRoutesPanel(); goto jdmj_; c_hiA: $this->isRegistered(); goto WiJ26; Vcc8O: $this->setGroupsPanel(); goto hcXQb; YH9Hv: $this->setRegistrationDataPanel(); goto OEocn; tBNZ0: $this->parseOptions(); goto c_hiA; cmwvh: XW6r8: goto R8Ape; JEJUf: if (!$this->sangomaCRM) { goto XW6r8; } goto Wd3IE; KTtIp: $this->setSettingsPanel(); goto JEJUf; YiOIh: $this->setTasksPanel(); goto Vcc8O; nVbmh: $this->setRoutingPointsPanel(); goto rxJhX; R8Ape: if ($this->registered) { goto a8vfG; } goto hVz6e; OEocn: $this->setProxySettingsPanel(); goto KTtIp; WiJ26: $this->isAuthenticated(); goto fpnQF; hVz6e: return; goto GGz_c; JPjHz: $this->HeadersToFields(); goto F5nxe; fpnQF: $this->setState(); goto HVNpR; GGz_c: a8vfG: goto nVbmh; FexVE: } protected function setState() { $this->state = State::get(array("\x72\145\147\x69\x73\164\145\162\x65\144" => $this->registered, "\x61\165\x74\150\x65\156\x74\151\143\x61\x74\145\x64" => $this->authenticated, "\141\165\x74\x68\125\x72\154" => '', "\163\145\x6c\x65\143\164\157\x72\163" => $this->setSelectors(), "\155\x73\x67\x73" => array(), "\x72\x65\x63\157\x72\144\151\156\x67\163" => array("\x6c\157\x61\144\151\156\x67" => false, "\x69\164\x65\x6d\x73" => Recordings::get()))); } protected function setMessages() { goto iVAX2; Zzw8s: AT0pn: goto EUbus; RR4C5: $this->state->addMessage(new Item(array("\164\x79\160\x65" => "\x65\162\x72\157\162", "\164\x65\170\x74" => $this->config["\x70\150\162\141\163\145\163"]->getDictionary("\x52\145\x67\120\141\x6e\145\154\76\155\x73\x67\x73\76\x53\x41\x4e\107\x4f\x4d\101\x5f\103\x52\x4d")))); goto Zzw8s; iVAX2: if (!$this->sangomaCRM) { goto AT0pn; } goto RR4C5; EUbus: } protected function setSelectors() { return array(array("\x6e\141\155\145" => "\x75\x73\x65\x72\163", "\143\157\155\x6d\x61\x6e\144" => "\147\x65\x74\125\163\x65\162\x73"), array("\x6e\x61\x6d\x65" => "\x64\145\163\x74\151\x6e\x61\164\x69\157\156\x73", "\143\x6f\155\155\141\156\x64" => "\144\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\123\145\154\145\x63\164\x73"), array("\156\141\155\145" => "\x73\157\x75\162\x63\x65\x73", "\143\157\x6d\x6d\x61\x6e\144" => "\147\x65\x74\123\157\x75\162\x63\145\163"), array("\x6e\x61\x6d\145" => "\164\141\163\x6b\163", "\x63\x6f\x6d\x6d\x61\156\x64" => "\147\145\164\x54\x61\x73\x6b\163\114\x69\x73\164"), array("\156\x61\x6d\x65" => "\147\162\157\165\160\163", "\143\x6f\155\155\x61\156\144" => "\x67\x65\x74\107\162\157\165\160\x73\114\x69\x73\x74"), array("\156\141\x6d\x65" => "\x6c\151\156\145\163", "\143\157\x6d\x6d\141\x6e\x64" => "\147\x65\x74\x4c\151\x6e\145\163\x53\x65\154\x65\x63\164\x6f\162\163")); } protected function setRegistrationDataPanel() { $this->state->addPanel(RegistrationData::Load($this->config, $this->registered)->get()); } protected function setProxySettingsPanel() { goto glkQ6; glkQ6: if (!(isset($this->config["\x73\150\x6f\167\x5f\143\165\162\x6c\x5f\160\x72\157\x78\x79"]) && $this->config["\163\x68\x6f\x77\x5f\143\x75\162\154\x5f\x70\x72\x6f\170\x79"] || empty($this->config["\143\x75\162\x6c\137\160\x72\x6f\x78\x79"]))) { goto HwFm3; } goto cNbum; jTXGr: HwFm3: goto eaNgf; cNbum: $this->state->addPanel(ProxySettings::Load($this->config, $this->registered)->get()); goto jTXGr; eaNgf: } protected function setSettingsPanel() { $this->state->addPanel(Settings::Load($this->config, $this->registered)->get()); } protected function setRoutingPointsPanel() { $this->state->addPanel(RoutingPoints::Load($this->config)->get()); } protected function setOutboundRoutesPanel() { $this->state->addPanel(OutboundRoutes::Load($this->config)->get()); } protected function setLinesPanel() { $this->state->addPanel(Lines::Load($this->config)->get()); } protected function setTasksPanel() { $this->state->addPanel(Tasks::Load($this->config)->get()); } protected function setGroupsPanel() { $this->state->addPanel(Groups::Load($this->config)->get()); } protected function setUponACallPanel() { $this->state->addPanel(UponACall::Load($this->config)->get()); } protected function HeadersToFields() { $this->state->addPanel(HeadersToFields::Load($this->config)->get()); } protected function isRegistered() { $this->registered = (bool) $this->config["\164\x6f\x6b\x65\156"]; } protected function isAuthenticated() { $this->authenticated = (isset($this->optionos["\x61\x75\164\x68\x65\156\164\151\x63\x61\x74\x65\x64"]) && $this->optionos["\141\165\x74\150\145\156\164\x69\143\141\x74\145\144"] == "\x74\162\165\x65" || isset($this->config["\141\165\164\150\x65\x6e\164\151\143\x61\x74\145\x64"])) && (bool) $this->config["\x61\x75\164\150\x65\156\x74\151\x63\141\164\145\x64"]; } protected function parseOptions() { goto EHNF1; NdIw2: $search = explode("\x26", $this->options["\x68\x61\x73\x68"]); goto uNyqp; uNyqp: if (!(!empty($search) && is_array($search))) { goto oeBjC; } goto frUZY; EHNF1: if (empty($this->options["\x68\141\x73\150"])) { goto ptYIQ; } goto NdIw2; TNShA: oeBjC: goto nDOkh; frUZY: foreach ($search as $item) { goto zzZEw; Zuq_W: pBD41: goto F54an; zzZEw: switch ($item) { case "\x70\x72\x6f\170\171": $this->config["\163\x68\157\x77\137\x63\x75\x72\154\137\x70\162\x6f\170\171"] = true; goto acvm8; case "\x61\144\144\x6f\156": $this->config["\163\x68\x6f\x77\137\141\144\x64\157\x6e\x5f\x75\x70\154\x6f\x61\144"] = true; goto acvm8; case "\x75\x6e\162\145\x67\151\x73\x74\x65\x72": $this->config["\163\150\157\167\x5f\165\x6e\x72\x65\147\151\163\x74\145\162"] = true; goto acvm8; } goto Zuq_W; F54an: acvm8: goto b60i1; b60i1: wiM1w: goto vG3pm; vG3pm: } goto N6kCk; N6kCk: gCFco: goto TNShA; nDOkh: ptYIQ: goto oWDNj; oWDNj: } }
