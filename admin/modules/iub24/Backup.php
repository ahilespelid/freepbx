<?php
 namespace FreePBX\modules\Iub24; use FreePBX\modules\Backup as Base; use Informunity\Classes\IUDB; use Symfony\Component\Filesystem\Filesystem; use Symfony\Component\Process\Process; class Backup extends Base\BackupBase { public $dirs = array(); public function runBackup($id, $transaction) { goto fPSGm; ImcRy: $addOnDir = $this->FreePBX->Iub24->config["\143\157\156\x66\137\144\x69\x72"]; goto AXsnS; d43sH: $this->buildFileStructure($amp_conf, $addOnDir)->addDirectories($this->dirs); goto S2VAm; CJF5B: unset($id, $transaction); goto mWM5b; AXsnS: if (!file_exists($addOnDir)) { goto uP5nK; } goto d43sH; f_cTk: $this->addConfigs($configs); goto CJF5B; fPSGm: global $amp_conf; goto ImcRy; S2VAm: $this->addConfigs(array("\141\144\x64\x4f\156\104\x69\162\x20" => $addOnDir)); goto TYLCd; TYLCd: uP5nK: goto NUbQP; NUbQP: $configs = array("\x74\141\142\x6c\145\x73" => $this->dumpDBTables("\x69\x75\x62\x32\64", false, IUDB::getTablesForBackup(true)), "\146\145\x61\164\165\x72\145\163" => $this->dumpFeatureCodes()); goto f_cTk; mWM5b: } public function buildFileStructure($amp_conf, $dir) { goto xuSbp; euVRf: $iterator = new \RecursiveIteratorIterator($directory); goto VV01l; xuSbp: $this->dirs[] = $dir; goto m5ibl; fQ8G0: $this->dirs = array_unique($this->dirs); goto Jq1Tb; VV01l: foreach ($iterator as $fileObj) { goto CI_g4; xwaiP: goto xssfH; goto YuFDB; YuFDB: W63Sk: goto fXzpo; fXzpo: $this->addFile($fileObj->getBasename(), $fileObj->getPath(), '', $fileObj->getExtension()); goto aLopL; CI_g4: if (!$fileObj->isDir()) { goto W63Sk; } goto cxn0m; cxn0m: $this->dirs[] = $fileObj->getPath(); goto xwaiP; aLopL: xssfH: goto WRoDC; WRoDC: } goto dUW6y; rCiqs: unset($amp_conf); goto PF3Nq; m5ibl: $directory = new \RecursiveDirectoryIterator($dir); goto euVRf; Jq1Tb: dbug($this->dirs); goto rCiqs; dUW6y: Sg4K_: goto fQ8G0; PF3Nq: return $this; goto Fv9pv; Fv9pv: } }
